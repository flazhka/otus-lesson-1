# Резервное копирование, настраиваем бэкапы

#### Домашнее задание: 
1. Скачать и развернуть Vagrant-стенд  
https://github.com/erlong15/otus-linux/tree/network
2. Построить следующую сетевую архитектуру:

Сеть office1
- 192.168.2.0/26      - dev
- 192.168.2.64/26     - test servers
- 192.168.2.128/26    - managers
- 192.168.2.192/26    - office hardware

Сеть office2
- 192.168.1.0/25      - dev
- 192.168.1.128/26    - test servers
- 192.168.1.192/26    - office hardware

Сеть central
- 192.168.0.0/28     - directors
- 192.168.0.32/28    - office hardware
- 192.168.0.64/26    - wifi

Office1 ---\
----> Central --IRouter --> internet
Office2----/

3. Итого должны получиться следующие сервера:  
![Alt text](https://github.com/flazhka/otuslab-homework/blob/master/Lab19/1.png)
inetRouter  
centralRouter  
office1Router  
office2Router  
centralServer  
office1Server  
office2Server  

4. Теоретической часть  
- Найти свободные подсети, 
- Посчитать количество узлов в каждой подсети, включая свободные
- Указать Broadcast-адрес для каждой подсети
- Проверить, нет ли ошибок при разбиении

5. В практической части: 
- Соединить офисы в сеть согласно логической схеме и настроить роутинг
Интернет-трафик со всех серверов должен ходить через inetRouter
- Все сервера должны видеть друг друга (должен проходить ping)
- У всех новых серверов отключить дефолт на NAT (eth0), который vagrant поднимает для связи
- Добавить дополнительные сетевые интерфейсы, если потребуется

#### Выполнение 
1. Скачан образ.
2. Постоена схема сети.  

Сеть office1
- 192.168.2.0/26      - dev
- 192.168.2.64/26     - test servers
- 192.168.2.128/26    - managers
- 192.168.2.192/26    - office hardware

Сеть office2
- 192.168.1.0/25      - dev
- 192.168.1.128/26    - test servers
- 192.168.1.192/26    - office hardware

Сеть central
- 192.168.0.0/28     - directors
- 192.168.0.32/28    - office hardware
- 192.168.0.64/26    - wifi

1. Возьмём все сети с адресами с 192.168.0.0-192.168.2.255 и выполним их зазбиение согласно методички на 10 подсетей, а также разложим сеть для маршрутизации 192.168.255.0/24 на подсети с разными масками. В итоге получим сл. таблицу адресов.

|Name|Network|Netmask|N|Hostmin|Hostmax|Broadcast|
|-|-|-|-|-|-|-|
|Central Network|					
|Directors|192.168.0.0/28|255.255.255.240|14|192.168.0.1|192.168.0.14|192.168.0.15|
|Свободная сеть|192.168.0.16/28|255.255.255.240|14|192.168.0.17|192.168.0.30|192.168.0.31|
|Office hardware|192.168.0.32/28|255.255.255.240|14|192.168.0.33|192.168.0.46|192.168.0.47|
|Свободная сеть|192.168.0.48/29|255.255.255.240|14|192.168.0.49|192.168.0.62|192.168.0.63|
|Wifi(mgt network)|192.168.0.64/26|255.255.255.192|62|192.168.0.65|192.168.0.126|192.168.0.127|
|Office 1 network|						
|Dev|192.168.2.0/26|255.255.255.192|62|192.168.2.1|192.168.2.62|192.168.2.63|
|Test|192.168.2.64/26|255.255.255.192|62|192.168.2.65|192.168.2.126|192.168.2.127|
|Managers|192.168.2.128/26|255.255.255.192|62|192.168.2.129|192.168.2.190|192.168.2.191|
|Office hardware|192.168.2.192/26|255.255.255.192|62|192.168.2.193|192.168.2.254|192.168.2.255|
|Office 2 network|						
|Dev|192.168.1.0/25|255.255.255.128|126|192.168.1.1|192.168.1.126|192.168.1.127|
|Test|192.168.1.128/26|255.255.255.192|62|192.168.1.129	192.168.1.190|192.168.1.191|
|Office|192.168.1.192/26|255.255.255.192|62|192.168.1.193|192.168.1.254|192.168.1.255|
|InetRouter — CentralRouter network|						
|Inet — central|192.168.255.0/30|255.255.255.252|2|192.168.255.1|192.168.255.2|192.168.255.3|
|Свободная сеть|192.168.255.4/30|255.255.255.252|2|192.168.255.5|192.168.255.6|192.168.255.7|
|Свободная сеть|192.168.255.8/29|255.255.255.248|6|192.168.255.9|192.168.255.14|192.168.255.15|
|Свободная сеть|192.168.255.16/28|255.255.255.240|14|192.168.255.17|192.168.255.30|192.168.255.31|
|Свободная сеть|192.168.255.32/27|255.255.255.224|30|192.168.255.33|192.168.255.62|192.168.255.63|
|Свободная сеть|192.168.255.64/26|255.255.255.192|62|192.168.255.65|192.168.255.126|192.168.255.127|
|Свободная сеть|192.168.255.128/25|255.255.255.128|126|192.168.255.129|192.168.255.254|192.168.255.255|

Определим адресацию сетевой лаборатории

|Server|IP/mask|
|-|-|
|InetRouter	|NAT VB|
||192.168.255.1/30|
|CentralRouter|	192.168.255.2/30|
||	192.168.0.1/28|
	192.168.0.33/28
	192.168.0.65/26
	192.168.255.9/30
	192.168.255.5/30
CentralServer	192.168.0.2/28
Office1Router	192.168.255.10/30
	192.168.2.1/26
	192.168.2.65/26
	192.168.2.129/26
	192.168.2.193/26
Office1Server	192.168.2.130/26
Office2Router	192.168.255.6/30
	192.168.1.1/26
	192.168.1.129/26
	192.168.1.193/26
Office2Server	192.168.1.2/26


| Тема                 |          Примеры            ||
| ^^                   |   Правильно   | Неправильно  |
| -------------------- | :-----------: | -----------: |
|Объявление переменных | ```          | ```           | \
|                      | var a = 2    | var a, b = 2  | \
|                      | ```          | ```           ||
| Наследование         | Главное не множественное     ||
[Справочник программиста]   



2. Практическая час представлена Vagrantfile файлом, который автоматически будет развертывать инфраструктуру. Для проверки соединения между оффисами был запущен ping что доказывает доступность в две стороны:

traceroute 192.168.255.1 # internetRouter  
```
PING 192.168.255.1 (192.168.255.1) 56(84) bytes of data.
64 bytes from 192.168.255.1: icmp_seq=1 ttl=60 time=123 ms
64 bytes from 192.168.255.1: icmp_seq=2 ttl=60 time=220 ms
64 bytes from 192.168.255.1: icmp_seq=3 ttl=60 time=42.2 ms
```

traceroute 192.168.255.2 # centralRouter
```
PING 192.168.255.2 (192.168.255.2) 56(84) bytes of data.
64 bytes from 192.168.255.2: icmp_seq=1 ttl=60 time=31.1 ms
64 bytes from 192.168.255.2: icmp_seq=2 ttl=60 time=25.5 ms
64 bytes from 192.168.255.2: icmp_seq=3 ttl=60 time=25.5 ms
```

traceroute 192.168.0.2   # centralServer
```
PING 192.168.0.2 (192.168.0.2) 56(84) bytes of data.
64 bytes from 192.168.0.2: icmp_seq=1 ttl=60 time=53.0 ms
64 bytes from 192.168.0.2: icmp_seq=2 ttl=60 time=46.8 ms
64 bytes from 192.168.0.2: icmp_seq=3 ttl=60 time=47.6 ms
```

traceroute 192.168.2.194 # office1Server
```
PING 192.168.2.194 (192.168.2.194 ) 56(84) bytes of data.
64 bytes from 192.168.2.194: icmp_seq=1 ttl=111 time=50.8 ms
64 bytes from 192.168.2.194: icmp_seq=2 ttl=111 time=48.3 ms
64 bytes from 192.168.2.194: icmp_seq=3 ttl=111 time=48.5 ms
```

traceroute 192.168.1.194 # office1Server
```
PING 192.168.1.194(192.168.1.194) 56(84) bytes of data.
64 bytes from 192.168.1.194: icmp_seq=1 ttl=58 time=36.9 ms
64 bytes from 192.168.1.194: icmp_seq=2 ttl=58 time=33.2 ms
64 bytes from 192.168.1.194: icmp_seq=3 ttl=58 time=37.6 ms
```